/* imgsrcset - Img srcset polyfill for resolution responsive images. Authors & copyright (c) 2012: WebLinc, David Knight. */

(function(a){var g=0,k=0;a.Imgsrcset={srcsets:[],parse:function(){this.srcsets=[];var e=a.document.getElementsByTagName("img")||[],c=e.length-1;do{var b=e[c],d=b.getAttribute("srcset")||"";d&&(this.srcsets.push({element:b,media:d,matches:!1}),g++)}while(c--)},parseMatch:function(e){e=e.replace(/\s*,\s*/,",").split(",");for(var c=e.length,b={src:"",media:"",matches:!1},d=!0;c--;){for(var g=e[c].match(/[^\s]+/g),j=g.length,d=!0;j--;){var f=g[j];if(0===j)b.src=f;else{var d=-1!==f.indexOf("w")&&"width"||
-1!==f.indexOf("h")&&"height"||-1!==f.indexOf("x")&&"resolution",h=f.match(/\d+/)[0],f=a.Media.features[d],h=a.Media.getAbsValue(h+("resolution"===d&&"dppx"||""));if(!(d="resolution"===d&&f===h||"resolution"!==d&&f<=h))break}}d&&(b.media=e[c],b.matches=d)}return b.matches&&b||!1},watch:function(){clearTimeout(k);k=setTimeout(function(){var e=g;do{var c=a.Imgsrcset.srcsets[e],b=!1;"undefined"!==typeof c&&((b=a.Imgsrcset.parseMatch(c.media))&&c.matches!==b.media?(c.matches=b.media,c.element.setAttribute("src",
b.src)):b||(c.matches=!1))}while(e--)},10)},init:function(){a.Imgsrcset.parse();a.Imgsrcset.watch();Media.listen(a.Imgsrcset.watch)}};a.addEventListener?a.addEventListener("load",a.Imgsrcset.init):a.attachEvent("onload",a.Imgsrcset.init)})(window);